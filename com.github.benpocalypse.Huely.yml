app-id: com.github.benpocalypse.Huely
runtime: org.freedesktop.Platform
runtime-version: '23.08'
base: 'io.elementary.BaseApp'
base-version: 'juno-23.08'
sdk: org.freedesktop.Sdk
command: com.github.benpocalypse.Huely

finish-args:
  - '--share=ipc'
  - '--share=network'
  - '--socket=fallback-x11'
  - '--socket=wayland'

modules:
  - name: libhandy
    buildsystem: meson
    config-opts:
      - -Dexamples=false
    sources:
      - type: archive
        url: https://download.gnome.org/sources/libhandy/1.8/libhandy-1.8.3.tar.xz
        sha256: 05b497229073ff557f10b326e074c5066f8743a302d4820ab97bcb5cd2dab087
  - name: Huely
    buildsystem: meson
    sources:
      - type: git
        url: https://github.com/benpocalypse/Huely.git
        tag: 0.4.3
        commit: d59f50e02bfd485039f43fd5970c001114ab7c5a
    post-install:
      # workaround for non-png-icon-in-hicolor-size-folder lint error
      - mkdir -p /app/share/icons/hicolor/scalable/apps
      - mv /app/share/icons/hicolor/128x128/apps/${FLATPAK_ID}.svg /app/share/icons/hicolor/scalable/apps/${FLATPAK_ID}.svg
      - find /app/share/icons/hicolor -type f -not -path "*scalable*" -not -path "*actions*" -name "*.svg" -delete
